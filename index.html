<!doctype html>
<html lang="uz" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PizzaShop - Tez yetkazib berish</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Poppins:wght@600;700;800&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Inter", system-ui, sans-serif;
      }
      .font-heading {
        font-family: "Poppins", sans-serif;
      }
    </style>
  </head>
  <body
    class="text-white bg-gradient-to-r from-[#180a01] via-[#1f0700] to-[#1f0a00]"
  >
    <section
      class="relative min-h-[953px] w-full overflow-hidden"
      style="width: 1512px; height: 953px; max-width: 1512px; margin: 0 auto"
    >
      <header
        class="relative z-20 flex items-center justify-between px-[130px] pt-8"
      >
        <div class="text-4xl font-extrabold tracking-tight font-heading">
          <img src="./public/svg/pizzashop.svg" alt="" />
        </div>

        <nav class="items-center hidden gap-10 text-lg font-medium md:flex">
          <a
            href="#"
            class="relative transition text-white/70 hover:text-orange-400 after:absolute after:left-1/2 after:-bottom-3 after:h-1.5 after:w-1.5 after:-translate-x-1/2 after:rounded-full after:bg-orange-400 after:opacity-0 hover:after:opacity-100 after:transition"
          >
            Home
          </a>

          <a
            href="#"
            class="relative transition text-white/70 hover:text-orange-400 after:absolute after:left-1/2 after:-bottom-3 after:h-1.5 after:w-1.5 after:-translate-x-1/2 after:rounded-full after:bg-orange-400 after:opacity-0 hover:after:opacity-100 after:transition"
          >
            Menu
          </a>

          <a
            href="#"
            class="relative transition text-white/70 hover:text-orange-400 after:absolute after:left-1/2 after:-bottom-3 after:h-1.5 after:w-1.5 after:-translate-x-1/2 after:rounded-full after:bg-orange-400 after:opacity-0 hover:after:opacity-100 after:transition"
          >
            Events
          </a>

          <a
            href="#"
            class="relative transition text-white/70 hover:text-orange-400 after:absolute after:left-1/2 after:-bottom-3 after:h-1.5 after:w-1.5 after:-translate-x-1/2 after:rounded-full after:bg-orange-400 after:opacity-0 hover:after:opacity-100 after:transition"
          >
            About us
          </a>
        </nav>

        <div class="flex items-center gap-4">
          <button
            class="text-lg font-semibold transition rounded-full w- bg-gradient-to-r from-orange-500 to-orange-600 hover:brightness-110 w-[163px] h-[40px]"
          >
            Log in
          </button>
          <button class="relative">
            <div
              class="flex items-center justify-center w-12 h-12 rounded-full"
            >
              <img src="./public/svg/nav-savat.svg" alt="" />
            </div>
          </button>
        </div>
      </header>
      <div class="flex mt-[61px]">
        <div
          class="relative z-10 flex flex-col items-start justify-center mt-[58px] px-[130px] text-start"
        >
          <h1 class="text-[69.17px] font-extrabold leading-[110%] mb-[30px]">
            The Fastest
            <span class="inline-block"
              ><img src="./public/svg/header-vector.svg" alt=""
            /></span>
            <br />
            Pizza ⚡ Delivery
          </h1>

          <p class="max-w-4xl mb-10 text-[19.56px] font-normal text-[#A3A3A3]">
            We will deliver juicy pizza for your family in 30 minutes,<br />
            if the courier is late –
            <span class="text-[#fff]">pizza is free!</span><br /><br />Cooking
            process:
          </p>

          <div
            class="relative flex flex-col items-center gap-12 mb-16 md:flex-row"
          >
            <div>
              <img
                src="./public/img/header-pizza.png"
                alt="Pizza tayyorlanayotgani"
              />
              <img
                src="./public/img/header-play.png"
                class="absolute right-[80px] bottom-[43px] cursor-pointer"
                alt="cheese"
              />
            </div>
          </div>

          <div class="flex">
            <div
              class="relative w-[388px] h-[62px] rounded-full border border-orange-400 flex items-center"
            >
              <div
                id="slider"
                class="absolute top-1 left-1 w-[188px] h-[54px] rounded-full bg-gradient-to-r from-orange-400 to-orange-500 transition-all duration-300 ease-in-out"
              ></div>

              <button
                onclick="setActive(0)"
                id="btn-order"
                class="relative z-10 w-1/2 h-full font-medium text-white transition"
              >
                To order
              </button>

              <button
                onclick="setActive(1)"
                id="btn-menu"
                class="relative z-10 w-1/2 h-full font-medium text-orange-400 transition"
              >
                Pizza-Menu
              </button>
            </div>
            <div class="pt-[15px] pl-[50px]">
              <img src="./public/svg/header-vector2.svg" alt="" />
            </div>
          </div>
        </div>
        <div class="w-[456px] h-[684px] relative">
          <img src="./public/img/header-img.png" alt="" />
          <img
            src="./public/img/header-fri.png"
            alt=""
            class="absolute bottom-[-130px] left-[-130px]"
          />
          <img
            src="./public/img/header-pizza1.png"
            alt=""
            class="absolute top-[-130px] right-[-130px]"
          />
        </div>
      </div>
    </section>
    <section class="relative px-10 py-20">
      <h2 class="m-auto text-center text-[69.17px] font-extrabold">Menu</h2>
      <div class="mx-auto max-w-7xl mt-[50px]">
        <div
          id="pizza-grid-1"
          class="grid grid-cols-1 gap-8 mb-16 sm:grid-cols-2 lg:grid-cols-4"
        ></div>

        <div class="mb-16 overflow-hidden rounded-2xl">
          <img
            src="./public/img/most.png"
            alt="Popular Pizza Banner"
            class="object-cover w-full h-48 brightness-75"
          />
        </div>

        <div
          id="pizza-grid-2"
          class="grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-4"
        ></div>
      </div>
    </section>
    <script>
      const slider = document.getElementById("slider");
      const btnOrder = document.getElementById("btn-order");
      const btnMenu = document.getElementById("btn-menu");

      function setActive(index) {
        if (index === 0) {
          slider.style.transform = "translateX(0)";
          btnOrder.classList.add("text-white");
          btnOrder.classList.remove("text-orange-400");
          btnMenu.classList.add("text-orange-400");
          btnMenu.classList.remove("text-white");
        } else {
          slider.style.transform = "translateX(190px)";
          btnMenu.classList.add("text-white");
          btnMenu.classList.remove("text-orange-400");
          btnOrder.classList.add("text-orange-400");
          btnOrder.classList.remove("text-white");
        }
      }

      const API_BASE_URL = window.location.hostname.includes("localhost")
        ? "http://localhost:5000"
        : "https://backend3-sandy.vercel.app";

      async function fetchPizzas() {
        try {
          const response = await fetch(API_BASE_URL + "/products", {
            method: "GET",
            headers: {
              Accept: "application/json",
            },
          });

          if (!response.ok) {
            throw new Error(
              `Server xatosi: ${response.status} ${response.statusText}`,
            );
          }

          const pizzas = await response.json();

          console.log("Yuklangan pizzalar soni:", pizzas.length);
          console.log("Birinchi pizza:", pizzas[0]);

          const grid1 = document.getElementById("pizza-grid-1");
          const grid2 = document.getElementById("pizza-grid-2");

          if (grid1) {
            grid1.innerHTML = "";
            pizzas.slice(0, 4).forEach((pizza) => {
              grid1.appendChild(createPizzaCard(pizza));
            });
          }

          if (grid2) {
            grid2.innerHTML = "";
            pizzas.slice(4, 8).forEach((pizza) => {
              grid2.appendChild(createPizzaCard(pizza));
            });
          }
        } catch (error) {
          console.error("Fetch xatosi:", error);

          const message = `
      Pizzalarni yuklab bo'lmadi.<br>
      Xato: ${error.message}<br><br>
      <small>Iltimos, backend ishlayotganligini va CORS sozlanganligini tekshiring.</small>
    `;

          [
            document.getElementById("pizza-grid-1"),
            document.getElementById("pizza-grid-2"),
          ].forEach((grid) => {
            if (grid) {
              grid.innerHTML = `<p class="text-lg text-center text-red-500 col-span-full">${message}</p>`;
            }
          });
        }
      }

      function createPizzaCard(pizza) {
        const card = document.createElement("div");
        card.className =
          "overflow-hidden transition-transform duration-300 transform border shadow-2xl from-gray-900 to-gray-800 rounded-3xl shadow-orange-900/30 border-orange-800/20 hover:scale-105";

        const formattedPrice = (pizza.price / 1000).toFixed(2);

        card.innerHTML = `
    <div class="relative">
      <img 
        src="${pizza.image}" 
        alt="${pizza.name}" 
        class="object-cover w-full h-48 rounded-t-3xl" 
        onerror="this.src='https://via.placeholder.com/400x300/111827/ffffff?text=${encodeURIComponent(pizza.name)}'"
      />
    </div>
    <div class="p-6 text-center">
      <h3 class="mb-2 text-2xl font-bold text-white font-heading">${pizza.name}</h3>
      <p class="mb-4 text-sm text-gray-300 line-clamp-3">${pizza.desc || "Tavsif yo‘q"}</p>

      <div class="flex justify-center gap-3 mb-5">
        <button class="text-sm font-medium text-white transition rounded-full w-11 h-11 bg-orange-600/30 hover:bg-orange-600">22</button>
        <button class="text-sm font-medium text-white transition rounded-full w-11 h-11 bg-orange-600/30 hover:bg-orange-600">28</button>
        <button class="text-sm font-medium text-white transition rounded-full w-11 h-11 bg-orange-600/30 hover:bg-orange-600">33</button>
      </div>

      <button class="w-full py-2.5 bg-orange-600/30 rounded-full text-orange-300 font-medium hover:bg-orange-600 hover:text-white transition mb-5 text-sm">
        + Ingredients
      </button>

      <div class="flex items-center justify-between px-2 mb-5">
        <span class="text-2xl font-bold text-white">${formattedPrice}$</span>
        
        <div class="flex items-center gap-3 px-4 py-2 rounded-full bg-gray-800/50 quantity-controls">
          <button class="w-8 h-8 font-bold text-white transition rounded-full decrement bg-orange-600/40 hover:bg-orange-600">-</button>
          <span class="w-6 text-lg font-semibold text-center quantity">1</span>
          <button class="w-8 h-8 font-bold text-white transition rounded-full increment bg-orange-600/40 hover:bg-orange-600">+</button>
        </div>
      </div>

      <button class="w-full py-4 text-lg font-bold transition rounded-full shadow-lg bg-gradient-to-r from-orange-500 to-orange-600 hover:brightness-110 hover:shadow-orange-600/50 order-btn">
        Order Now
      </button>
    </div>
  `;

        const quantitySpan = card.querySelector(".quantity");
        const decrementBtn = card.querySelector(".decrement");
        const incrementBtn = card.querySelector(".increment");

        let quantity = 1;

        incrementBtn.addEventListener("click", () => {
          quantity++;
          quantitySpan.textContent = quantity;
        });

        decrementBtn.addEventListener("click", () => {
          if (quantity > 1) {
            quantity--;
            quantitySpan.textContent = quantity;
          }
        });
        return card;
      }

      document.addEventListener("DOMContentLoaded", fetchPizzas);
    </script>
  </body>
</html>
